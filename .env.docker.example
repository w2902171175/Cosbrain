# ================================================================================
# Docker Environment Configuration Template
# 复制此文件为 .env.docker 并根据您的需求修改配置
# ================================================================================

# -------- Application --------
PRODUCTION=true
HOST=0.0.0.0
PORT=8001
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# -------- JWT/Auth --------
# 重要：在生产环境中，请生成新的安全密钥
SECRET_KEY=your_secret_key_here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440

# System-wide encryption key (generate a new one for production)
ENCRYPTION_KEY=your_encryption_key_here

# -------- Database (Docker Services) --------
POSTGRES_DB=cosbrain
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=db
POSTGRES_PORT=5432

# SQLAlchemy 会自动构建连接字符串
DATABASE_URL=postgresql+psycopg2://postgres:postgres@db:5432/cosbrain

# SQLAlchemy 连接池与日志
SQL_ECHO=false
SQL_POOL_SIZE=10
SQL_MAX_OVERFLOW=20
SQL_POOL_TIMEOUT=30
SQL_POOL_RECYCLE=3600

# -------- Redis (Docker Service) --------
ENABLE_REDIS=true
REDIS_URL=redis://redis:6379/0
CACHE_DEFAULT_EXPIRE=3600
CACHE_ENABLE_COMPRESSION=true
CACHE_COMPRESSION_THRESHOLD=1024
CACHE_MAX_MEMORY_SIZE=1000

# -------- Storage (选择一个存储方案) --------

# 选项 1: MinIO (Docker Service) - 推荐用于开发和测试
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin
S3_ACCESS_KEY_ID=minioadmin
S3_SECRET_ACCESS_KEY=minioadmin
S3_ENDPOINT_URL=http://minio:9000
S3_BUCKET_NAME=cosbrain
S3_REGION=us-east-1
S3_BASE_URL=http://localhost:9000

# 选项 2: 外部 S3 兼容服务 (取消注释以使用)
# S3_ACCESS_KEY_ID=your_access_key
# S3_SECRET_ACCESS_KEY=your_secret_key
# S3_ENDPOINT_URL=https://your-s3-endpoint.com
# S3_BUCKET_NAME=your_bucket_name
# S3_REGION=your_region
# S3_BASE_URL=https://your-cdn-domain.com

# -------- YARA Security Scanning --------
ENABLE_YARA_SCAN=true
YARA_RULES_PATH=/app/yara/rules/rules.yar
YARA_OUTPUT_DIR=/app/yara/output

# -------- 文件安全配置 --------
MAX_FILE_SIZE=104857600  # 100MB
ALLOWED_FILE_TYPES=images,documents,videos,audio
ENABLE_VIRUS_SCAN=false
QUARANTINE_PATH=/app/quarantine
ENABLE_FILE_SIGNATURE_CHECK=true

# -------- 输入安全配置 --------
MAX_CONTENT_LENGTH=50000
MAX_TITLE_LENGTH=200
MIN_TITLE_LENGTH=5
MAX_USERNAME_LENGTH=20
MIN_USERNAME_LENGTH=2
ENABLE_AI_DETECTION=false
ENABLE_LANGUAGE_DETECTION=true
ENABLE_SENTIMENT_ANALYSIS=false
ENABLE_ADVANCED_XSS=true
ENABLE_UNICODE_NORM=true

# -------- 安全配置 --------
ENABLE_RATE_LIMITING=true
ENABLE_CONTENT_MODERATION=true
ENABLE_XSS_PROTECTION=true

# -------- Docker 特定配置 --------
# 在容器启动时是否重新初始化数据库（生产环境中应该为 false）
RUN_DB_INIT=false

# 容器日志配置
CONTAINER_LOG_LEVEL=INFO
CONTAINER_LOG_FORMAT=json
